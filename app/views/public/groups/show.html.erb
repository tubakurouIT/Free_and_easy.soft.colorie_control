<div class="container my-5">
  <!-- Error Messages -->
  <div class="mb-4">
    <%= render 'layouts/errors', obj: @free_post %>
  </div>

  <div class="row">
    <!-- Member Info and New Free Post Form -->
    <div class="col-md-3">
      <div class="card shadow-sm mb-4">
        <div class="card-body">
          <h2 class="text-primary mb-4">Member Info</h2>
          <%= render partial: "public/members/info", locals: { member: @member } %>
        </div>
      </div>

      <div class="card shadow-sm">
        <div class="card-body">
          <h2 class="text-primary mb-4">New Free Post</h2>
          <%= render partial: "public/free_posts/form", locals: { free_post: @free_post } %>
        </div>
      </div>
    </div>

    <!-- Group Detail -->
    <div class="col-md-8 offset-md-1">
      <div class="card shadow-sm">
        <div class="card-body">
          <h2 class="text-primary mb-4">Group Detail</h2>
          <table class="table table-bordered table-striped align-middle">
            <thead class="table-primary">
              <tr>
                <th>Image</th>
                <th>グループ名</th>
                <th>紹介文</th>
                <th>メンバー</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <!-- Group Image -->
                <td>
                  <%= image_tag @group.get_group_image, size: "50x50", class: "rounded" %>
                </td>

                <!-- Group Name -->
                <td>
                  <strong><%= @group.name %></strong>
                </td>

                <!-- Group Introduction -->
                <td>
                  <%= @group.introduction %>
                </td>

                <!-- Group Members -->
                <td>
                  <ul class="list-unstyled">
                    <% @group.members.each do |member| %>
                      <li><%= member.name %></li>
                    <% end %>
                  </ul>
                </td>

                <!-- Actions -->
                <td>
                  <% if @group.owner_id == current_member.id %>
                    <div class="d-flex gap-2">
                      <%= link_to "Edit", edit_group_path(@group), class: "btn btn-sm btn-success" %>
                      <%= link_to "グループを削除", group_path(@group), method: :delete, data: { confirm: "本当に削除しても良いですか？" }, class: "btn btn-sm btn-danger" %>
                    </div>
                  <% elsif current_member.email != "guest@example.com" %>
                    <% if @group.include_member?(current_member) %>
                      <%= link_to "Leave this group", group_group_members_path(@group), method: :delete, class: "btn btn-sm btn-danger" %>
                    <% else %>
                      <%= link_to "Join this group", group_group_members_path(@group), method: :post, class: "btn btn-sm btn-success" %>
                    <% end %>
                  <% end %>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
